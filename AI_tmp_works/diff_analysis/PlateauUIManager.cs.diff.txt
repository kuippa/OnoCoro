Change Type: significant_change
ILSpy: g:\unity\OnoCoro2026\Assets\Recovery\.Editor\ILspy_CS\PlateauUIManager.cs
Scripts: g:\unity\OnoCoro2026\Assets\Scripts\Plateau\PlateauUIManager.cs
================================================================================

--- PlateauUIManager.cs+++ PlateauUIManager.cs@@ -1,115 +1,149 @@-// Assembly-CSharp, Version=0.0.0.0, Culture=neutral, PublicKeyToken=null
-// PlateauUIManager
 using System;
+using UnityEngine;
+using UnityEngine.UI;
+using UnityEngine.EventSystems;
 using System.Collections.Generic;
 using CommonsUtility;
-using UnityEngine;
-using UnityEngine.UI;
+
 
 public class PlateauUIManager : MonoBehaviour
 {
-	private GameObject _infoBox;
+    private GameObject _infoBox;
+    internal static PlateauInfoManager _plateauInfoManager = null;
+    
+    internal void DisplayBuildingInfo(Dictionary<string, string> buildingInfo, float rebuildCost, bool isDoomedBuilding)
+    {
+        GameObject infoBox = GetInfoBox();
+        string infoText = FormatBuildingInfo(buildingInfo, rebuildCost);
 
-	internal static PlateauInfoManager _plateauInfoManager;
+        GameObject pnlInfo = infoBox.transform.Find("pnlInfo").gameObject;
+        GameObject txtInfo = pnlInfo.transform.Find("txtInfo").gameObject;
+        Text txtInfoText = txtInfo.GetComponent<Text>();
+        txtInfoText.text = infoText;
+        GameObject pnlRebuild = pnlInfo.transform.Find("pnlRebuild").gameObject;
+        GameObject pnlBreak = pnlInfo.transform.Find("pnlBreak").gameObject;
+        GameObject pnlDelete = pnlInfo.transform.Find("pnlDelete").gameObject;
 
-	internal void DisplayBuildingInfo(Dictionary<string, string> buildingInfo, float rebuildCost, bool isDoomedBuilding)
-	{
-		GameObject infoBox = GetInfoBox();
-		string text = FormatBuildingInfo(buildingInfo, rebuildCost);
-		GameObject obj = infoBox.transform.Find("pnlInfo").gameObject;
-		obj.transform.Find("txtInfo").gameObject.GetComponent<Text>().text = text;
-		GameObject gameObject = obj.transform.Find("pnlRebuild").gameObject;
-		GameObject gameObject2 = obj.transform.Find("pnlBreak").gameObject;
-		GameObject gameObject3 = obj.transform.Find("pnlDelete").gameObject;
-		if (!IsDemLod(buildingInfo))
-		{
-			gameObject.SetActive(isDoomedBuilding);
-			if (isDoomedBuilding)
-			{
-				gameObject.transform.Find("txtRebuild").gameObject.GetComponent<Text>().text = " - " + rebuildCost + "BIT";
-			}
-			gameObject2.SetActive(!isDoomedBuilding);
-			gameObject3.SetActive(value: false);
-			if (GameConfig._APP_GAME_MODE == "debug")
-			{
-				gameObject3.SetActive(value: true);
-			}
-		}
-		else
-		{
-			gameObject.SetActive(value: false);
-			gameObject2.SetActive(value: false);
-			gameObject3.SetActive(value: false);
-		}
-		infoBox.SetActive(value: true);
-	}
+        bool isDemLod = IsDemLod(buildingInfo);
+        if (!isDemLod)
+        {
+            pnlRebuild.SetActive(isDoomedBuilding);
+            if (isDoomedBuilding)
+            {
+                GameObject txtRebuild = pnlRebuild.transform.Find("txtRebuild").gameObject;
+                Text txtRebuildText = txtRebuild.GetComponent<Text>();
+                txtRebuildText.text = " - " + rebuildCost.ToString() + GlobalConst.SHORT_SCORE1_SCALE;
+            }
 
-	internal void CloseInfoBox()
-	{
-		GetInfoBox().SetActive(value: false);
-	}
+            pnlBreak.SetActive(!isDoomedBuilding);
+            // if (!isDoomedBuilding)
+            // {
+            //     GameObject txtBreak = pnlRebuild.transform.Find("txtBreak").gameObject;
+            //     Text txtBreakText = txtBreak.GetComponent<Text>();
+            //     // txtBreakText.text = " - " + rebuildCost.ToString() + GlobalConst.SHORT_SCORE1_SCALE;
+            // }
 
-	private void Awake()
-	{
-		InitBuildingInfo();
-	}
+            pnlDelete.SetActive(false);
+            if (GameConfig._APP_GAME_MODE == GlobalConst.GAME_MODE_DEBUG)
+            {
+                    pnlDelete.SetActive(true);
+            }
+        }
+        else
+        {
+            pnlRebuild.SetActive(false);
+            pnlBreak.SetActive(false);
+            pnlDelete.SetActive(false);
+        }
+        infoBox.SetActive(true);
+    }
 
-	private void InitBuildingInfo()
-	{
-		if (_plateauInfoManager == null)
-		{
-			_plateauInfoManager = base.gameObject.GetComponent<PlateauInfoManager>();
-		}
-	}
+    internal void CloseInfoBox()
+    {
+        GameObject infoBox = GetInfoBox();
+        infoBox.SetActive(false);
+        // GameObjectTreat.DestroyAll(infoBox);
+    }
 
-	internal GameObject GetInfoBox()
-	{
-		if (_infoBox != null)
-		{
-			return _infoBox;
-		}
-		GameObject gameObject = GameObject.Find("UIBuildingInfo");
-		if (gameObject == null)
-		{
-			gameObject = UnityEngine.Object.Instantiate(Resources.Load("Prefabs/UI/UIBuildingInfo") as GameObject);
-			gameObject.name = "UIBuildingInfo";
-			_plateauInfoManager = base.gameObject.GetComponent<PlateauInfoManager>();
-			_plateauInfoManager.InitPlateauInfoWindow();
-		}
-		_infoBox = gameObject;
-		return gameObject;
-	}
+    void Awake()
+    {
+        InitBuildingInfo();
+    }
 
-	private bool IsDemLod(Dictionary<string, string> buildingInfo)
-	{
-		if (buildingInfo.ContainsKey("dem:lod"))
-		{
-			return true;
-		}
-		return false;
-	}
+    private void InitBuildingInfo()
+    {
+        if (_plateauInfoManager == null)
+        {
+            _plateauInfoManager = this.gameObject.GetComponent<PlateauInfoManager>();
+        }
 
-	private string FormatBuildingInfo(Dictionary<string, string> buildingInfo, float rebuildCost)
-	{
-		string text = "";
-		foreach (KeyValuePair<string, string> item in buildingInfo)
-		{
-			string langVal = LangCtrl.GetLangVal(item.Key);
-			if (!string.IsNullOrEmpty(langVal))
-			{
-				text = text + langVal + ": " + item.Value + Environment.NewLine;
-			}
-		}
-		return text;
-	}
+    }
 
-	internal void ShowInsufficientFundsMessage()
-	{
-		Debug.Log("再建コストが足りません");
-		TelopCtrl component = GameObject.Find("UITelop").GetComponent<TelopCtrl>();
-		if (component != null)
-		{
-			component.ShowTelop("Not enough the rebuild power", isSubTelop: true);
-		}
-	}
+
+    internal GameObject GetInfoBox()
+    {
+        if (_infoBox != null)
+        {
+            return _infoBox;
+        }
+        
+        GameObject infoBox = GameObject.Find("UIBuildingInfo");
+        if (infoBox == null)
+        {
+            infoBox = Instantiate(Resources.Load("Prefabs/UI/UIBuildingInfo") as GameObject);
+            infoBox.name = "UIBuildingInfo";
+            _plateauInfoManager = this.gameObject.GetComponent<PlateauInfoManager>();
+            _plateauInfoManager.InitPlateauInfoWindow();
+        }
+
+        _infoBox = infoBox;
+        return infoBox;
+    }
+
+    private bool IsDemLod(Dictionary<string, string> buildingInfo)
+    {
+        // "key": "dem:lod",
+        // dem:lodモードの場合はtrueを返す
+        if (buildingInfo.ContainsKey("dem:lod"))
+        {
+            return true;
+        }
+        return false;
+    }
+
+
+    private string FormatBuildingInfo(Dictionary<string, string> buildingInfo, float rebuildCost)
+    {
+        string formattedInfo = "";
+        foreach (var pair in buildingInfo)
+        {
+            string langH = LangCtrl.GetLangVal(pair.Key);
+            if (!string.IsNullOrEmpty(langH))
+            {
+                formattedInfo += $"{langH}: {pair.Value}{Environment.NewLine}";
+                // formattedInfo += $"{langH}: {pair.Value}\n";
+                // formattedInfo += $"{langH}: {pair.Key} {pair.Value}\n";
+            }
+            else
+            {
+                // formattedInfo += $"{pair.Key}: {pair.Value}\n";
+                // Debug.Log($"{pair.Key}: {pair.Value}");
+            }
+        }
+        // formattedInfo += LangCtrl.GetLangVal("rebuildcost") + ": " + rebuildCost + "\n";
+        return formattedInfo;
+    }
+
+    internal void ShowInsufficientFundsMessage()
+    {
+        // TODO:再建できない場合の処理
+        Debug.Log("再建コストが足りません");
+        TelopCtrl telopCtrl = GameObject.Find("UITelop").GetComponent<TelopCtrl>();
+        if (telopCtrl != null)
+        {
+            telopCtrl.ShowTelop("Not enough the rebuild power", true);
+        }
+
+    }
+
 }


================================================================================
Significant Changes: 199
-	private GameObject _infoBox;

+    private GameObject _infoBox;

+    internal static PlateauInfoManager _plateauInfoManager = null;

+    internal void DisplayBuildingInfo(Dictionary<string, string> buildingInfo, float rebuildCost, bool isDoomedBuilding)

+    {

+        GameObject infoBox = GetInfoBox();

+        string infoText = FormatBuildingInfo(buildingInfo, rebuildCost);

-	internal static PlateauInfoManager _plateauInfoManager;

+        GameObject pnlInfo = infoBox.transform.Find("pnlInfo").gameObject;

+        GameObject txtInfo = pnlInfo.transform.Find("txtInfo").gameObject;

+        Text txtInfoText = txtInfo.GetComponent<Text>();

+        txtInfoText.text = infoText;

+        GameObject pnlRebuild = pnlInfo.transform.Find("pnlRebuild").gameObject;

+        GameObject pnlBreak = pnlInfo.transform.Find("pnlBreak").gameObject;

+        GameObject pnlDelete = pnlInfo.transform.Find("pnlDelete").gameObject;

-	internal void DisplayBuildingInfo(Dictionary<string, string> buildingInfo, float rebuildCost, bool isDoomedBuilding)

-	{

-		GameObject infoBox = GetInfoBox();

-		string text = FormatBuildingInfo(buildingInfo, rebuildCost);

-		GameObject obj = infoBox.transform.Find("pnlInfo").gameObject;

