Change Type: significant_change
ILSpy: g:\unity\OnoCoro2026\Assets\Recovery\.Editor\ILspy_CS\ItemListCtrl.cs
Scripts: g:\unity\OnoCoro2026\Assets\Scripts\Item\ItemListCtrl.cs
================================================================================

--- ItemListCtrl.cs+++ ItemListCtrl.cs@@ -1,50 +1,111 @@-// Assembly-CSharp, Version=0.0.0.0, Culture=neutral, PublicKeyToken=null
-// ItemListCtrl
+using System.Collections;
+using System.Collections.Generic;
 using UnityEngine;
+using UnityEngine.UI;
+using CommonsUtility;
 
 public class ItemListCtrl : MonoBehaviour
 {
-	private const int _ITEM_LIST_MAX = 26;
+    const int _ITEM_LIST_MAX = 26;
 
-	private int GetChildFreeHolderIndex(ItemStruct item_struct)
-	{
-		int result = -1;
-		int childCount = base.transform.childCount;
-		for (int i = 0; i < childCount; i++)
-		{
-			int appendableItemIndex = base.transform.GetChild(i).gameObject.GetComponent<ItemHolderCtrl>().GetAppendableItemIndex(item_struct);
-			if (appendableItemIndex != -1)
-			{
-				result = appendableItemIndex;
-				break;
-			}
-		}
-		return result;
-	}
+    private int GetChildFreeHolderIndex(ItemStruct item_struct)
+    {
+        int ret = -1;
+        // 子供要素数を取得
+        int childCount = this.transform.childCount;
 
-	internal void SetItemStruct(ItemStruct item_struct)
-	{
-		int childFreeHolderIndex = GetChildFreeHolderIndex(item_struct);
-		if (childFreeHolderIndex != -1)
-		{
-			base.transform.GetChild(childFreeHolderIndex).gameObject.GetComponent<ItemHolderCtrl>().AddItemToHolder(item_struct);
-		}
-	}
+        for (int i = 0; i < childCount; i++)
+        {
+            GameObject unit = this.transform.GetChild(i).gameObject;
+            int free_index = unit.GetComponent<ItemHolderCtrl>().GetAppendableItemIndex(item_struct);
+            if (free_index != -1)
+            {
+                ret = free_index;
+                break;
+            }
+            else
+            {
+                // Debug.Log("free_index: " + free_index + " i: " + i);
+            }
+        }
+        return ret;
+    }
 
-	private void Awake()
-	{
-		foreach (Transform item in base.transform)
-		{
-			Object.Destroy(item.gameObject);
-		}
-		int childCount = base.transform.childCount;
-		int num = 26 - childCount;
-		for (int i = 0; i < num; i++)
-		{
-			GameObject gameObject = Object.Instantiate(Resources.Load<GameObject>("Prefabs/UI/Item_holder"));
-			gameObject.transform.SetParent(base.transform);
-			gameObject.GetComponent<ItemHolderCtrl>().ChangeSiblingIndex(gameObject.transform.GetSiblingIndex());
-		}
-		base.gameObject.AddComponent<LoupeCtrl>();
-	}
+    internal void SetItemStruct(ItemStruct item_struct)
+    {
+        int idx = GetChildFreeHolderIndex(item_struct);
+        if (idx != -1)
+        {
+            GameObject unit = this.transform.GetChild(idx).gameObject;
+            // Debug.Log("idx: " + idx + " unit: " + unit.name + " unit.GetSiblingIndex: " + unit.transform.GetSiblingIndex());
+            unit.GetComponent<ItemHolderCtrl>().AddItemToHolder(item_struct);
+        }
+    }
+
+    internal void SelectItem(int index)
+    {
+        int childCount = this.transform.childCount;
+        if (childCount < index)
+        {
+            return;
+        }
+        int item_index = index - 1;
+
+        GameObject item = this.transform.Find("Item_" + item_index).gameObject;
+        Button button = item.GetComponent<Button>();
+        if (button != null)
+        {
+            // itemの子要素が空ではなかった場合
+            ItemStruct item_struct =  item.GetComponent<ItemHolderCtrl>().GetItem();
+            if (item_struct.Name != null)
+            {
+                // Debug.Log($"item_struct: {item_struct.Name} {item_struct.Info}");
+                SpawnMarkerPointerCtrl.SetMarkerActive(true);
+                button.Select();
+            }
+            else
+            {
+                SpawnMarkerPointerCtrl.SetMarkerActive(false);
+                button.Select();
+                button.OnDeselect(null);
+            }
+        }
+    }
+
+    void Awake()
+    {
+        // 子要素をすべて削除
+        foreach (Transform child in this.transform)
+        {
+            GameObject.Destroy(child.gameObject);
+        }
+
+        // 子供要素数を取得
+        int childCount = this.transform.childCount;
+        int list_cnt = _ITEM_LIST_MAX - childCount;
+
+        for (int i = 0; i < list_cnt; i++)
+        {
+            GameObject Item_holder_prefab = Resources.Load<GameObject>("Prefabs/UI/Item_holder");
+            GameObject unit = Instantiate(Item_holder_prefab);
+            unit.transform.SetParent(this.transform);
+            unit.GetComponent<ItemHolderCtrl>().ChangeSiblingIndex(unit.transform.GetSiblingIndex());
+        }
+
+        // 虫眼鏡を作成
+        LoupeCtrl loupeCtrl = this.gameObject.AddComponent<LoupeCtrl>();
+        // bool ret = LoupeCtrl.IsLoupe();
+
+        // ItemStruct itemLoupe = new ItemStruct();
+        // itemLoupe = this.gameObject.AddComponent<Loupe>()._item_struct;
+        // ItemListCtrl itemListCtrl = this.gameObject.GetComponentInChildren<ItemListCtrl>();
+        // itemListCtrl.SetItemStruct(itemLoupe);
+
+        
+        // GameObjectTreat.DebugScriptList();
+
+
+    }
+
+
 }


================================================================================
Significant Changes: 112
-	private const int _ITEM_LIST_MAX = 26;

+    const int _ITEM_LIST_MAX = 26;

-	private int GetChildFreeHolderIndex(ItemStruct item_struct)

-	{

-		int result = -1;

-		int childCount = base.transform.childCount;

-		for (int i = 0; i < childCount; i++)

-		{

-			int appendableItemIndex = base.transform.GetChild(i).gameObject.GetComponent<ItemHolderCtrl>().GetAppendableItemIndex(item_struct);

-			if (appendableItemIndex != -1)

-			{

-				result = appendableItemIndex;

-				break;

-			}

-		}

-		return result;

-	}

+    private int GetChildFreeHolderIndex(ItemStruct item_struct)

+    {

+        int ret = -1;

