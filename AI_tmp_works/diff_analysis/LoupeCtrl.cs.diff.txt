Change Type: significant_change
ILSpy: g:\unity\OnoCoro2026\Assets\Recovery\.Editor\ILspy_CS\LoupeCtrl.cs
Scripts: g:\unity\OnoCoro2026\Assets\Scripts\Item\LoupeCtrl.cs
================================================================================

--- LoupeCtrl.cs+++ LoupeCtrl.cs@@ -1,59 +1,94 @@-// Assembly-CSharp, Version=0.0.0.0, Culture=neutral, PublicKeyToken=null
-// LoupeCtrl
 using UnityEngine;
+using UnityEngine.UI;
+using UnityEngine.InputSystem;
+using UnityEditor;
+using UnityEngine.EventSystems;
+using CommonsUtility;
+using Unity.VisualScripting;
 
 public class LoupeCtrl : MonoBehaviour
 {
-	public static LoupeCtrl instance;
+    public static LoupeCtrl instance = null;
+    internal static bool _loupeMode = false;
 
-	private static ItemStruct _item;
+    private static ItemStruct _item = new ItemStruct();
+    // private static ItemHolderCtrl _itemHolderCtrl = null;
 
-	internal static bool IsLoupe(string item_name)
-	{
-		if (item_name == _item.Name)
-		{
-			Debug.Log("IsLoupe: " + item_name + "  _item.Name: " + _item.Name);
-			return true;
-		}
-		return false;
-	}
 
-	internal static void ActLoupe()
-	{
-		GameObject gameObject = GameObject.Find("Plateau");
-		if (gameObject == null)
-		{
-			return;
-		}
-		if (gameObject.GetComponent<PlateauInfoManager>().IsPlateauObject())
-		{
-			gameObject.GetComponent<PlateauInfoManager>().DisplayPlateauInfo();
-			return;
-		}
-		GameObject gameObject2 = GameObject.Find("UIInfo");
-		if (gameObject2 != null)
-		{
-			gameObject2.GetComponent<InfoWindowCtrl>().GetTargetUnit();
-		}
-	}
+    internal static bool IsLoupe()
+    {
+        return _loupeMode;
+    }
 
-	private void OnDestory()
-	{
-		if (instance == this)
-		{
-			instance = null;
-		}
-	}
+    internal static bool IsLoupe(string item_name)
+    {
+        
+        // if (item_name == "Loupe")
+        if (item_name == _item.Name)
+        {
+            SetLoupeMode(true);
+            return true;
+        }
+        return false;
+    }
 
-	private void Awake()
-	{
-		if (instance == null)
-		{
-			instance = this;
-		}
-		ItemStruct itemStruct = default(ItemStruct);
-		itemStruct = base.gameObject.AddComponent<Loupe>()._item_struct;
-		base.gameObject.GetComponentInChildren<ItemListCtrl>().SetItemStruct(itemStruct);
-		_item = itemStruct;
-	}
+    internal static void SetLoupeMode(bool mode)
+    {
+        _loupeMode = mode;
+    }
+ 
+    internal static void ActLoupe()
+    {
+        _loupeMode = false;
+        GameObject plateauInfo  = GameObject.Find(GlobalConst.PLATEAU_OBJ_NAME);
+        if (plateauInfo == null)
+        {
+            return;
+        }
+        // Plateau 建物情報表示
+        // bool boolplateau = plateauInfo.GetComponent<PlateauInfo>().GetPlateauInfo();
+
+        bool boolplateau = plateauInfo.GetComponent<PlateauInfoManager>().IsPlateauObject();
+        // Plateau 以外のユニットなどの情報を表示
+        // if (!boolplateau)
+        if (boolplateau)
+        {
+            plateauInfo.GetComponent<PlateauInfoManager>().DisplayPlateauInfo();
+        }
+        else
+        {
+            GameObject uiInfo = GameObject.Find(GlobalConst.UI_INFO_OBJ_NAME);
+            if (uiInfo != null)
+            {
+                uiInfo.GetComponent<InfoWindowCtrl>().GetTargetUnit();
+                // uiInfo.GetComponent<InfoWindowCtrl>().ToggleInfoWindow(true);
+            }
+            return;
+        }
+    }
+
+    void OnDestory()
+    {
+        // Debug.Log(this.GetType().FullName + " " + System.Reflection.MethodBase.GetCurrentMethod().Name);
+        if (instance == this)
+        {
+            instance = null;
+        }
+    }
+
+    void Awake()
+    {
+        // Debug.Log(this.GetType().FullName + " " + System.Reflection.MethodBase.GetCurrentMethod().Name);
+        if (instance == null)
+        {
+            instance = this;
+        }
+
+        ItemStruct itemLoupe = new ItemStruct();
+        itemLoupe = this.gameObject.AddComponent<Loupe>()._item_struct;
+        ItemListCtrl itemListCtrl = this.gameObject.GetComponentInChildren<ItemListCtrl>();
+        itemListCtrl.SetItemStruct(itemLoupe);
+        _item = itemLoupe;
+    }
+
 }


================================================================================
Significant Changes: 109
-	public static LoupeCtrl instance;

+    public static LoupeCtrl instance = null;

+    internal static bool _loupeMode = false;

-	private static ItemStruct _item;

+    private static ItemStruct _item = new ItemStruct();

-	internal static bool IsLoupe(string item_name)

-	{

-		if (item_name == _item.Name)

-		{

-			Debug.Log("IsLoupe: " + item_name + "  _item.Name: " + _item.Name);

-			return true;

-		}

-		return false;

-	}

-	internal static void ActLoupe()

-	{

-		GameObject gameObject = GameObject.Find("Plateau");

-		if (gameObject == null)

-		{

-			return;

