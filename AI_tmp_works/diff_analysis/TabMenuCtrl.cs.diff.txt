Change Type: significant_change
ILSpy: g:\unity\OnoCoro2026\Assets\Recovery\.Editor\ILspy_CS\TabMenuCtrl.cs
Scripts: g:\unity\OnoCoro2026\Assets\Scripts\UI\TabMenuCtrl.cs
================================================================================

--- TabMenuCtrl.cs+++ TabMenuCtrl.cs@@ -1,104 +1,87 @@-// Assembly-CSharp, Version=0.0.0.0, Culture=neutral, PublicKeyToken=null
-// TabMenuCtrl
+using System.Collections;
+using System.Collections.Generic;
 using UnityEngine;
+using UnityEngine.UI;
+using UnityEngine.SceneManagement;
 using UnityEngine.EventSystems;
+using CommonsUtility;
 
 public class TabMenuCtrl : MonoBehaviour
 {
-	internal bool _item_box_open = true;
+    internal bool _item_box_open = true;
+    private ItemCreateCtrl _item_create_window = null;
+    private InfoWindowCtrl _infoWindowCtrl = null;
 
-	private ItemCreateCtrl _item_create_window;
+    public void ToggleTabMenuWindow()
+    {
+        GameObject itemtoolbar = GameObject.Find("UIItem");
+        if (itemtoolbar != null)
+        {
+            RectTransform rect = itemtoolbar.transform.Find("ItemBox").GetComponent<RectTransform>();
+            // 250 と 60でトグル
+            if (!_item_box_open) {
+                rect.sizeDelta = new Vector2(260f, 252f);
+                ToggleCreateWindow(true);
+                // ITemBox -> BG -> ItemList -> Item_0  Item_0 にフォーカスを当てる
+                RectTransform item_list = rect.transform.Find("BG").Find("ItemList").GetComponent<RectTransform>();
+                EventSystem.current.SetSelectedGameObject(item_list.transform.GetChild(0).gameObject);
+            }
+            else
+            {
+                rect.sizeDelta = new Vector2(260f, 60f);
+                ToggleCreateWindow(false);
+                CloseUIInfoWindow();
+                EventSystem.current.SetSelectedGameObject(null);
+                SpawnMarkerPointerCtrl.SetMarkerActive(false);                
+            }
+            rect.anchoredPosition = new Vector3(rect.anchoredPosition.x, -1*rect.sizeDelta.y/2, 0f);
+            _item_box_open = !_item_box_open;
+        }
+    }
 
-	private InfoWindowCtrl _infoWindowCtrl;
+    public bool GetTabMenuWindowStatus()
+    {
+        return _item_box_open;
+    }
 
-	public void ToggleTabMenuWindow()
-	{
-		GameObject gameObject = GameObject.Find("UIItem");
-		if (gameObject == null)
-		{
-			ToggleCreateWindow(isOn: false);
-			return;
-		}
-		RectTransform component = gameObject.transform.Find("ItemBox").GetComponent<RectTransform>();
-		if (!_item_box_open)
-		{
-			component.sizeDelta = new Vector2(260f, 252f);
-			ToggleCreateWindow(isOn: true);
-			RectTransform component2 = component.transform.Find("BG").Find("ItemList").GetComponent<RectTransform>();
-			EventSystem.current.SetSelectedGameObject(component2.transform.GetChild(0).gameObject);
-		}
-		else
-		{
-			component.sizeDelta = new Vector2(260f, 60f);
-			ToggleCreateWindow(isOn: false);
-			CloseUIInfoWindow();
-			EventSystem.current.SetSelectedGameObject(null);
-			SpawnMarkerPointerCtrl.SetMarkerActive(isActive: false);
-		}
-		component.anchoredPosition = new Vector3(component.anchoredPosition.x, -1f * component.sizeDelta.y / 2f, 0f);
-		_item_box_open = !_item_box_open;
-	}
+    private void CloseUIInfoWindow()
+    {
+        if (_infoWindowCtrl == null)
+        {
+            GameObject uiInfo = GameObject.Find(GlobalConst.UI_INFO_OBJ_NAME);
+            if (uiInfo == null)
+            {
+                return;
+            }
+            _infoWindowCtrl = uiInfo.transform.GetComponent<InfoWindowCtrl>();
+        }
+        _infoWindowCtrl.ToggleInfoWindow(false);
+    }
 
-	public bool IsTabMenuWindowOpen()
-	{
-		return _item_box_open;
-	}
+    private void ToggleCreateWindow(bool isOn)
+    {
+        if (_item_create_window == null)
+        {
+            GameObject createWindow = GameObject.Find("UIItemCreate");
+            if (createWindow == null)
+            {
+                return;
+            }
+            _item_create_window = createWindow.transform.GetComponent<ItemCreateCtrl>();
+        }
+        _item_create_window.SwitchActive(isOn);
 
-	public bool GetTabMenuWindowStatus()
-	{
-		return _item_box_open;
-	}
+        // tooltipも消す
+        GameObject[] tooltips = GameObject.FindGameObjectsWithTag("UIToolTips");
+        foreach (GameObject tooltip in tooltips)
+        {
+            Destroy(tooltip);
+        }
 
-	private void CloseUIInfoWindow()
-	{
-		if (_infoWindowCtrl == null)
-		{
-			GameObject gameObject = GameObject.Find("UIInfo");
-			if (gameObject == null)
-			{
-				return;
-			}
-			_infoWindowCtrl = gameObject.transform.GetComponent<InfoWindowCtrl>();
-		}
-		_infoWindowCtrl.ToggleInfoWindow(isActive: false);
-	}
+    }
 
-	private void ToggleCreateWindow(bool isOn)
-	{
-		if (_item_create_window == null)
-		{
-			GameObject gameObject = GameObject.Find("UIItemCreate");
-			if (gameObject == null)
-			{
-				return;
-			}
-			_item_create_window = gameObject.transform.GetComponent<ItemCreateCtrl>();
-		}
-		_item_create_window.SwitchActive(isOn);
-		GameObject gameObject2 = GameObject.Find("UIBG_mask");
-		if (isOn)
-		{
-			gameObject2.transform.GetComponent<CanvasGroup>().alpha = 0.8f;
-			gameObject2.transform.GetComponent<CanvasGroup>().blocksRaycasts = true;
-		}
-		else
-		{
-			gameObject2.transform.GetComponent<CanvasGroup>().alpha = 0f;
-			gameObject2.transform.GetComponent<CanvasGroup>().blocksRaycasts = false;
-		}
-		GameObject[] array = GameObject.FindGameObjectsWithTag("UIToolTips");
-		for (int i = 0; i < array.Length; i++)
-		{
-			Object.Destroy(array[i]);
-		}
-	}
-
-	private void Start()
-	{
-		ToggleTabMenuWindow();
-	}
-
-	private void Awake()
-	{
-	}
+    void Awake()
+    {
+        ToggleTabMenuWindow();
+    }
 }


================================================================================
Significant Changes: 153
-	internal bool _item_box_open = true;

+    internal bool _item_box_open = true;

+    private ItemCreateCtrl _item_create_window = null;

+    private InfoWindowCtrl _infoWindowCtrl = null;

-	private ItemCreateCtrl _item_create_window;

+    public void ToggleTabMenuWindow()

+    {

+        GameObject itemtoolbar = GameObject.Find("UIItem");

+        if (itemtoolbar != null)

+        {

+            RectTransform rect = itemtoolbar.transform.Find("ItemBox").GetComponent<RectTransform>();

+            if (!_item_box_open) {

+                rect.sizeDelta = new Vector2(260f, 252f);

+                ToggleCreateWindow(true);

+                RectTransform item_list = rect.transform.Find("BG").Find("ItemList").GetComponent<RectTransform>();

+                EventSystem.current.SetSelectedGameObject(item_list.transform.GetChild(0).gameObject);

+            }

+            else

+            {

+                rect.sizeDelta = new Vector2(260f, 60f);

