# Prototype Phase ロードマップ

テストユーザーへのリリース（v0.1.0-alpha）を目標とした実装計画書

**目標リリース**: 2026-02-末まで  
**対象**: テストユーザー向け初期版（進行不能バグなし、基本的なゲーム性確保）

---

## 📊 Prototype Phase 全体構成

```
Week 1-2: コア機能整備 & デバッグ環境構築
Week 2-3: ステージデザイン & ゲーム性調整
Week 3-4: QA & リリース準備
```

---

## Phase 1: コア機能整備 & デバッグ環境 (Week 1-2)

### 1.1 ログシステムの統一化

**目的**: デバッグ効率化、ユーザー報告の品質向上  
**優先度**: 🔴 最高

#### 実装内容

| タスク | 詳細 | 担当 | 期間 |
|--------|------|------|------|
| **LogUtility 拡張** | Debug.Log → LogUtility 統一 | Dev | 2-3日 |
| **DebugLogger 実装** | ファイル出力機能（.log生成） | Dev | 2-3日 |
| **コード全体の置換** | Assets/Scripts/ 内のすべての Debug → LogUtility/DebugLogger へ | Dev | 3-4日 |
| **ログレベル設定** | Development Build 時の出力制御 | Dev | 1日 |
| **ユーザー向けログガイド** | ドキュメント作成 | Doc | 1日 |

**参考**: [docs/debug-logger-guide.md](debug-logger-guide.md)

**チェックリスト**:
- [ ] LogUtility.cs で5段階ログレベル実装（Debug/Info/Warning/Error/Fatal）
- [ ] Application.persistentDataPath へログファイル出力
- [ ] Development Build でのログ表示フィルタ
- [ ] すべての Debug.Log* を置換済み
- [ ] 既存 Debug.Log は出力されないことを確認

---

### 1.2 YAML バリデーション システム

**目的**: ステージデータの不整合による進行不能バグを事前防止  
**優先度**: 🔴 最高

#### 実装内容

| タスク | 詳細 | 担当 | 期間 |
|--------|------|------|------|
| **YamlValidator クラス実装** | 検証ロジック実装 | Dev | 2-3日 |
| **検証対象の定義** | pathmakers, itemlists, stages, goals, boards | Doc | 1日 |
| **Editor スクリプト作成** | 事前チェック UI | Dev | 2日 |
| **エラーメッセージ定義** | ユーザー向け出力 | Doc | 1日 |

**参考**: [docs/yaml-validation-guide.md](yaml-validation-guide.md)

**検証項目**:
```
pathmakers セクション:
- マーカー名の一意性
- 座標形式の正確性（lat, lon の範囲チェック）
- マーカータイプの妥当性（start, goal, checkpoint）

itemlists セクション:
- item_name の定義確認
- cost/benefit のバランスチェック

stages セクション:
- stage_id の一意性
- 参照マーカーの存在確認
- difficulty range の妥当性

goals セクション:
- goal_type の妥当性
- target_value の整数チェック

boards セクション:
- board_size の妥当性（推奨: 5×5 ～ 20×20）
- spawn_point の有効性
```

**チェックリスト**:
- [ ] YamlValidator クラス実装
- [ ] Editor スクリプトでの事前チェック機能
- [ ] エラーログ出力機能
- [ ] 既存 YAML ファイルのバリデーション完了

---

### 1.3 UI タグ導入 & キャンバス動的調整

**目的**: UI レスポンシビリティ向上、キャンバスサイズ対応  
**優先度**: 🟡 高

#### 実装内容

| タスク | 詳細 | 担当 | 期間 |
|--------|------|------|------|
| **UI プレファブへタグ付与** | すべての UI Prefab に UITag を追加 | Dev | 1-2日 |
| **キャンバスレイヤーの動的調整** | Canvas Size の動的変更機能 | Dev | 2日 |
| **複数画面解像度テスト** | 1920×1080, 1280×720, タブレット対応 | QA | 2日 |

**チェックリスト**:
- [ ] すべての UI Prefab に UITag 付与
- [ ] キャンバスサイズ動的変更機能実装
- [ ] 複数解像度でのテスト完了
- [ ] モバイル対応の可否判定

---

### 1.4 Resources.Load 統一化

**目的**: アセット管理の一元化、メモリ効率化  
**優先度**: 🟡 高

#### 実装内容

| タスク | 詳細 | 担当 | 期間 |
|--------|------|------|------|
| **Resources.Load の全検索** | コード内のすべての Resources.Load を特定 | Dev | 1日 |
| **PrefabManager 置換** | 非対応部分を PrefabManager で統一 | Dev | 2-3日 |
| **Bonfire 削除確認** | 不要アセットの削除 | Dev | 1日 |

**参考**: [.github/instructions/prefab-asset-management.instructions.md](.github/instructions/prefab-asset-management.instructions.md)

**チェックリスト**:
- [ ] すべての Resources.Load を grep で特定
- [ ] PrefabManager で統一
- [ ] 不要アセット削除
- [ ] メモリプロファイルで改善確認

---

## Phase 2: ステージデザイン & ゲーム性調整 (Week 2-3)

### 2.1 ステージレベルデザイン (5段階)

**目的**: チュートリアル → 中級 → 上級への段階的進行  
**優先度**: 🔴 最高

#### ステージ構成

| ステージ | 難易度 | 目的 | 開発工数 |
|---------|--------|------|---------|
| **Stage 1: チュートリアル** | Easy | タワー配置基本操作 | 3日 |
| **Stage 2: 基本マップ** | Normal | 複数敵タイプ対応 | 4日 |
| **Stage 3: 複合マップ** | Normal | 複合タワー戦略 | 4日 |
| **Stage 4: 高難度マップ** | Hard | 全タイプ敵出現 | 5日 |
| **Stage 5: エクストラ** | Very Hard | 制限時間チャレンジ | 5日 |

#### ステージ設計チェックリスト

**すべてのステージで確認**:
- [ ] PLATEAU 地形データとの整合性
- [ ] スポーン点配置の妥当性（敵が詰まらない）
- [ ] タワー配置可能エリアの明確化
- [ ] ゴール到達不可能なバグがないか
- [ ] ウェーブ難易度のバランス
- [ ] UI 表示の見易さ（遮蔽の確認）
- [ ] パフォーマンス測定（FPS 60+ 安定）
- [ ] 完全攻略ルートが存在するか

---

### 2.2 ゲームバランス調整

**目的**: 難易度の適切な段階化、リプレイ性向上  
**優先度**: 🔴 最高

#### バランス調整項目

| 要素 | 調整項目 | 指標 |
|------|---------|------|
| **ユニット コスト** | タワーのコスト・効果比 | 完全攻略時間 8-15分 |
| **敵難易度** | 敵ユニット HP・速度 | クリア成功率 60-70% |
| **リソース配分** | 初期ゴールド・毎ターンゴールド増加 | 中盤以降の選択肢確保 |
| **ウェーブ構成** | 敵の出現パターン | 単調性排除 |

**バランステスト方法**:
```
各ステージ 10回プレイ
→ クリア率、平均時間、戦略多様性を測定
→ データに基づいてコスト・敵パラメータ調整
```

**チェックリスト**:
- [ ] 全ステージでコスト表調整完了
- [ ] 敵パラメータ調整完了
- [ ] 10回プレイテスト完了
- [ ] バランス調整ドキュメント作成

---

### 2.3 カメラ制御の最適化

**目的**: ユーザー体験向上、操作感改善  
**優先度**: 🟡 高

#### 実装内容

| タスク | 詳細 | 期間 |
|--------|------|------|
| **ズームレベル再調整** | 動作感・速度の改善 | 2日 |
| **視界カメラの障害物対応** | 上下反転バグの修正 | 2日 |
| **カメラ制御のチュートリアル** | UI ガイダンス追加 | 2日 |

**テスト項目**:
- [ ] ズーム速度が自然か（期待値: 0.5秒で target zoom に到達）
- [ ] 障害物衝突時に上下反転しないか
- [ ] カメラが地面に沈まないか
- [ ] 移動時のラグがないか

---

### 2.4 Z-Fighting 対策

**目的**: 画面ちらつき排除  
**優先度**: 🟡 中

#### 実装内容

| タスク | 詳細 |
|--------|------|
| **問題箇所の特定** | 同じ優先順位の描画オブジェクトを検索 |
| **y座標微調整** | オブジェクト位置を微調整（±0.01 単位） |
| **Sorting Order 調整** | Canvas・UI Layer の整理 |

**チェックリスト**:
- [ ] すべてのステージでちらつき排除
- [ ] Sorting Order ドキュメント作成

---

## Phase 3: QA & リリース準備 (Week 3-4)

### 3.1 進行不能バグの排除

**目的**: ゲーム進行を阻害するバグを 100% 解決  
**優先度**: 🔴 最高

#### テスト項目

| バグカテゴリ | テスト内容 | チェック |
|-------------|----------|--------|
| **クリア不可** | 敵が詰まる、タワー配置不可、ゴール到達不可 | [ ] |
| **UI 非応答** | ボタン無反応、メニュー固定 | [ ] |
| **データ破損** | ステージロード失敗、YAML パース失敗 | [ ] |
| **クラッシュ** | NullReferenceException、OutOfMemory | [ ] |

#### テスト実行方法

```
Development Build で実行
→ PlayerPrefs リセット
→ すべてのステージ完全攻略プレイ
→ ログ確認（Error/Exception なし）
→ 異常終了なし
```

**チェックリスト**:
- [ ] 全ステージクリア可能
- [ ] 10時間以上連続プレイでクラッシュなし
- [ ] メモリリークなし（Profiler 確認）
- [ ] エラーログ出力なし（LogUtility で確認）

---

### 3.2 パフォーマンス確保

**目的**: 60 FPS 安定、メモリ効率化  
**優先度**: 🔴 最高

#### 測定項目

| 項目 | 目標値 | 測定方法 |
|------|--------|---------|
| **フレームレート** | 60 FPS（最小 45 FPS） | Profiler Frame Debugger |
| **メモリ使用量** | < 1GB | Memory Profiler |
| **ロード時間** | < 3秒/ステージ | Profiler |

**最適化チェックリスト**:
- [ ] Profiler で FPS 測定
- [ ] GameObject.Find() の廃止完了
- [ ] Resources.Load 一元化完了
- [ ] Texture 圧縮設定確認
- [ ] Physics.autoSimulation の最適化確認

---

### 3.3 ユーザー向けドキュメント

**目的**: テストユーザーの利便性向上  
**優先度**: 🟡 高

#### ドキュメント種別

| ドキュメント | 内容 | 分量 |
|-------------|------|------|
| **README_Prototype.md** | ゲーム概要・操作方法 | 500字 |
| **GAMEPLAY_GUIDE.md** | ゲーム進行ガイド・戦略 | 1000字 |
| **KNOWN_ISSUES.md** | 既知の問題・回避方法 | 500字 |
| **BUG_REPORT_TEMPLATE.md** | バグ報告テンプレート | 300字 |
| **LOG_GUIDE.md** | ログファイル場所・確認方法 | 200字 |

**チェックリスト**:
- [ ] README_Prototype.md 作成
- [ ] GAMEPLAY_GUIDE.md 作成
- [ ] KNOWN_ISSUES.md 作成
- [ ] BUG_REPORT_TEMPLATE.md 作成
- [ ] LOG_GUIDE.md 作成

---

### 3.4 リリース前最終チェック

**目的**: 本番環境での動作確認  
**優先度**: 🔴 最高

#### チェックリスト

- [ ] **ビルド確認**
  - [ ] Debug Build 成功
  - [ ] Development Build 成功
  - [ ] Release Build 成功
  
- [ ] **プラットフォーム確認**
  - [ ] Windows 10/11（メイン対象）
  - [ ] GPU 互換性（Intel/NVIDIA/AMD）
  - [ ] 最低仕様の環境での動作確認
  
- [ ] **バージョン情報**
  - [ ] Version 0.1.0-alpha に設定
  - [ ] BuildNumber 001 に設定
  - [ ] CHANGELOG.md 記載
  
- [ ] **バグ登録**
  - [ ] 発見バグを GitHub Issues に登録
  - [ ] Priority/Labels を設定
  - [ ] 2026-02-末での対応予定確認

---

### 3.5 リリース & テストユーザー対応

**目的**: 安定した初期版配布  
**優先度**: 🔴 最高

#### リリースプロセス

```
1. Git tag: v0.1.0-alpha 作成
   git tag -a "v0.1.0-alpha" -m "Prototype Phase リリース"
   
2. Release notes 作成
   - 新機能一覧
   - 既知の問題
   - 必要な環境
   - インストール手順
   
3. テストユーザー配布
   - GitHub Releases で配布
   - Discord/Slack で通知
   - バグ報告チャネル設定
   
4. テストユーザー対応
   - 日次ログ確認
   - 致命的バグは即日修正
   - 軽微なバグは Alpha 版に纏める
```

**チェックリスト**:
- [ ] v0.1.0-alpha tag 作成
- [ ] Release notes 作成
- [ ] ビルド成果物準備
- [ ] テストユーザー配布完了
- [ ] バグ報告チャネル設定完了

---

## 📈 リソース配分

```
Week 1-2:
- ログシステム: 5人日
- YAML バリデーション: 4人日
- UI/リソース: 3人日
[計: 12人日]

Week 2-3:
- ステージ設計: 10人日（5ステージ × 2日）
- バランス調整: 8人日（テスト・調整）
- カメラ・UI 改善: 4人日
[計: 22人日]

Week 3-4:
- QA テスト: 12人日
- バグ修正: 8人日
- ドキュメント: 4人日
- リリース準備: 2人日
[計: 26人日]

**合計**: 約 60 人日（1人チームで 3-4週間）
```

---

## 🎯 成功指標

Prototype Phase 完了時の評価基準：

| 指標 | 目標値 | 達成判定 |
|------|--------|---------|
| **ゲームプレイ時間** | 平均 10-15 分/ステージ | [ ] |
| **クリア成功率** | 初見 50-60% | [ ] |
| **クラッシュ率** | 0% | [ ] |
| **フレームレート** | 60 FPS (45 FPS最小) | [ ] |
| **メモリ使用量** | < 1 GB | [ ] |
| **ステージ数** | 5+（チュートリアル含む） | [ ] |
| **ドキュメント整備** | 5ファイル以上 | [ ] |
| **テストユーザー評価** | 3.0/5.0 以上 | [ ] |

---

## 📝 次フェーズへの引き継ぎ

Prototype Phase 完了後、Alpha Phase では以下の大規模機能を実装：

- PlayMode バグ修正（複数シーン対応）
- 敵経路最適化（NavMesh 動的再ベイク）
- SentryGuard アーキテクチャ統一
- InitializationManager 全クラス対応

詳細: [docs/alpha-phase.md](alpha-phase.md)（未作成、作成予定）

---

**ロードマップ作成日**: 2026-01-23  
**対象版**: v0.1.0-alpha (Prototype Phase)  
**想定完了日**: 2026-02-28
